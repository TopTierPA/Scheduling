<h1>Iframe Page</h1>
<p id="status">Waiting for parent...</p>

<script>
  window.addEventListener('DOMContentLoaded', () => {
    // Tell parent we are ready
    window.parent.postMessage({ type: 'iframe-ready' }, '*');

    // Listen for messages from parent
    window.addEventListener('message', (event) => {
      console.log('Iframe received from parent:', event.data);
      const receivedData = event.data;

      if (receivedData && receivedData.dealId) {
        document.getElementById('status').textContent =
          `Received dealId: ${receivedData.dealId}, scheduleType: ${receivedData.scheduleType}`;

        // Send a response back to parent
        window.parent.postMessage({
          type: 'iframe-response',
          message: 'Iframe successfully received the data!',
          data: receivedData
        }, '*');
      }
    });
  });
</script>
